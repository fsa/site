---
layout: post
title: Установка GRUB2
date: 2013-10-15 02:56:00 +0500
tags: [grub, Gentoo]
excerpt: Переход на использование Grub 2 для запуска Gentoo
published: false
redirect_from:
  - /blog/grub2/
  - /2013/10/grub2.html
---
После недавнего обновления portage в gentoo прилетела обновка для GRUB. Отныне GRUB2 считается стабильным, а значит при апгрейде системы будет установлен. Причин оставаться на GRUB Legacy я не вижу, поэтому решил проапгрейдиться.

Последовательность действий для обновления:

1. в /etc/portage/make.conf добавляем переменную, указывающую, что наш GRUB собирается для платформы PC:

    ```ini
    GRUB_PLATFORMS="pc"
    ```

2. обновляем grub через emerge;
3. монтируем папку /boot если она у вас на отдельном разделе;
4. устанавливаем новую версию grub (вот тут я себе набил шишку):

    ```bash
    grub2-install /dev/sda
    ```

    Обязательно указываем непосредственно HDD, а не раздел на нём!!! Никаких sda1!!!
5. Правим файл `/etc/defaults/grub` где указываем нужные опции (читаем документацию), например, я себе включил дефолтную тему со звёздами;
6. Создаём файл конфигурации grub, который является ничем иным, как скриптом (кстати, его не рекомендуется изменять непосредственно, а только через правку файла из предыдущего пункта):

    ```bash
    grub2-mkconfig -o /boot/grub/grub.cfg
    ```

    В процессе формирования проверяются все имеющиеся в `/boot` ядра, по умолчанию будет загружаться самое старшее ядро (если вы не правили `/etc/default/grub`).

На этом всё. Ваша система при следующем запуске должна успешно стартовать. Если кроме Linux у вас на компьютере есть другие операционные системы, то установите `sys-boot/os-prober`.
