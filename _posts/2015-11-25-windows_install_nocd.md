---
layout: post
title: Как я ставил Windows без DVD/CD, флешки и сети
redirect_from:
  - /blog/Windows_install_Virtualbox/
  - /2015/11/windows.html
date: 2015-11-25 15:17:00 +0500
tags: [Windows, Linux, VirtualBox]
excerpt: Установка операционной системы на примере установки Windows с использованием работающей ОС с установленным VirtualBox
---
Возникла тут задача установить Windows на компьютер без DVD/CD.

Первая мысль была установить с флешки. День колдовал с флешкой, ничего не грузится. Даже Ubuntu пробовал. Загружается. А Windows установочный никак. Кстати, позже проверил флешку на другом ПК, там всё загрузилось.

Вторая мысль - загрузиться по сети и установить. наличие настроенного сервера делало эту задачу, вроде бы, легко выполнимой. Но нет. Облегчённая версия Windows успешно грузилась по сети и в тот момент когда можно было бы подключать сетевой диск с дистрибутивом сетевая карта неожиданно умирала. Точнее пропадал линк и Windows PE уходила в вечное ожидание сети.

И тут в голову неожиданно пришла идея поставить систему в виртуальной машине... БРЕД? Нет. Всё сработало!.

Что нам необходимо для установки:

* VirtualBox;
* Образ системы на диске или в файле ISO (ну или любой другой формат, которые съест VirtualBox);
* Контейнер для HDD или, на крайний случай, место в системнике для подключения второго винта на который будет ставиться система.

Приступаем к установке.

Для начала выясним как обзывается мой второй HDD. На Linux сделать это проще простого. Подключаю внешний диск и смотрю что появилось в `/dev` - у меня это `/dev/sdb`. Отлично. Создаю в удобном месте файл `sdb.vmdk`:

```bash
VBoxManage internalcommands createrawvmdk -filename sdb.vmdk -rawdisk /dev/sdb
```

Виртуальный образ, а точнее ссылка на реальный HDD, для VirtualBox создан. Остаётся создать новую машинку, использовать в качестве HDD созданный образ и подключить желаемый ISO-образ с дистрибутивом в качестве CD/DVD. Не забываем о правах доступа к `/dev/sdb*`. Или даём при подключении права 666 на все разделы, или вступаем в группу `disk` (или как группа называется в вашем дистрибутиве Linux).

Начинаем установку Windows. Ждём пока установка дойдёт до первой перезагрузки и выключаем виртуальную машину. Этого можно и не делать и продолжить установку внутри виртуальной машины. Но, в этом случае, Windows будет сконфигурирована для виртуального железа и могут возникнуть проблемы с запуском на реальном железе.

После выключения виртуальной машины, достаём HDD из контейнера и ставим в наш ПК. Включаем ПК и наблюдаем продолжение установки уже на реальной машине. Всё. Система установлена.

## Загрузка ОС в виртуальной машине

Аналогично можно загружать с дисков любые операционные системы, в том числе Windows. Однако могут возникнуть проблемы с некоторыми устройствами, т.к. «железо» виртуальной машины отличается от реального. Однако я успешно запускал Windows XP и Windows 7, правда, не без танцев с бубном.

## Заключение

Установка операционной системы с помощью виртуальной машины — вполне рабочий способ. При его использовании могут возникать незначительные проблемы, по сравнению с классическими способами установки, но они решаемы. Данный способ установки подходит не только для установки Windows, но и любых других операционных систем. Например, я таким же способом я ставил Fedora из Gentoo.

Метод отлично подходит и в ситуации, когда в вашем ноутбуке 2 диска и необходимо переустановить Windows на одном из дисков. В случае установки с внешнего носителя могут возникнуть проблемы с корректной установкой Windows, т.к. она может разместить загрузочный раздел не на том диске. Обычно это решается отключением неиспользуемых при установке дисков. Однако это требует разборки ноутбука. Виртуальная машина даст установщику Windows доступ только на тот диск, куда вы хотите установить Windows.
